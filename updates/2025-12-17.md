# 2025-12-17

## 作業内容
- Claude Code の Skills 機能を導入し、Agents と使い分けを整理
  - `troubleshooter.md` を `.claude/skills/troubleshooting/SKILL.md` に移行
  - `coding-standards` Skill を新規作成（Python/Terraform コーディング規約）
  - `project-architecture` Skill を新規作成（データフロー・インフラ構成）
  - Agents は作業実行用に簡素化し、Skill への参照を追加
- SerpAPI から Perplexity API への移行
  - `services/research.py` を完全書き換え（新データ構造 + Perplexity SDK）
  - `services/profile.py` から `analyze_job_matches()` を削除（Perplexity が分析も担当）
  - `app.py` の表示ロジックを新構造に対応
  - Terraform の Secret Manager 参照を変更
- pyproject.toml から `[build-system]` を削除し、editable install をスキップ

## 学び

### Skills vs Agents の使い分け
| | Skills | Agents |
|---|--------|--------|
| 呼び出し | Claude が自動参照 | Task ツールで明示的に起動 |
| 実行 | メイン会話内 | サブプロセスで独立実行 |
| 用途 | 知識・ルール・制約の提供 | 複雑なタスクの自律的実行 |

**判断基準**: 「常に参照すべき情報」→ Skill、「作業を丸ごと任せたい」→ Agent

### Perplexity API の特徴
- OpenAI互換の SDK（`from perplexity import Perplexity`）
- `response_format` で JSON Schema を指定すると構造化出力が可能
- Web検索 + 分析を1回のAPI呼び出しで完結（SerpAPI + Vertex AI の2段階が不要に）
- 初回 JSON Schema リクエストは 10-30 秒かかる可能性あり

### uv の editable install 制御
- `uv sync` はデフォルトでプロジェクトを editable install する
- `[build-system]` セクションを削除すると editable install をスキップ
- または `--no-install-project` フラグで依存関係のみインストール可能
