# 2026-01-11

## 作業内容
- Blue-Green デプロイ対応
  - Cloud Run 2環境構成（Blue: 本番、Green: 検証）
  - URL Mapでパスベースルーティング（`/` → Blue, `/green/*` → Green）
  - Green用OAuth App設定（環境ごとに別シークレット）
  - Green環境のIAM制限（指定ユーザーのみアクセス可）
- 運用スクリプト追加
  - `scripts/proxy-green.sh` - Green環境へのローカルプロキシ
  - `scripts/rollback.sh` - 前リビジョンへのロールバック
- ドキュメント更新（CLAUDE.md, project-architecture, troubleshooting）

## 学び
- **IAP（Identity-Aware Proxy）は組織アカウントが必要** - 個人GCPアカウントでは利用不可。代替として Cloud Run の IAM 制限 + OAuth 認証を採用
- **OAuth AppはCallback URLが環境ごとに異なるため、Blue/Green別々に作成が必要** - 1つのOAuth Appを共有できない
- **Cloud Run の `gcloud run services proxy` でローカルから認証済みアクセス可能** - IAM制限されたサービスでも検証できる
